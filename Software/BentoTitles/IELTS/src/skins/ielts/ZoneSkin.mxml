<?xml version="1.0" encoding="utf-8"?>
<s:Skin xmlns:fx="http://ns.adobe.com/mxml/2009" 
		xmlns:s="library://ns.adobe.com/flex/spark" 
		xmlns:mx="library://ns.adobe.com/flex/mx" 
		xmlns:ui="com.clarityenglish.ielts.view.zone.ui.*"
		xmlns:tink="ws.tink.spark.containers.*"
		xmlns:flashcomponents="*"
		currentState="normal">
	<!-- host component -->
	<fx:Metadata>
		[HostComponent("com.clarityenglish.ielts.view.zone.ZoneView")]
	</fx:Metadata>
	<fx:Script>
		<![CDATA[
			import com.clarityenglish.ielts.view.zone.ExerciseEvent;
			
			import spark.events.IndexChangeEvent;
			import spark.events.ListEvent;
			
			protected function onUnitItemRollOver(event:ListEvent):void {
				unitCaption.text = event.item.@caption;
				unitDescription.text = event.item.@description;
			}
			
			protected function onUnitChange(event:IndexChangeEvent):void {
				currentState = "exercise_selector";
			}
			
			protected function onAccordianChange(event:IndexChangeEvent):void {
				currentState = "normal";
			}
			
			protected function onPopoutExerciseSelected(event:ExerciseEvent):void {
				currentState = "normal";
			}
			
			protected function onAdviceZoneVideoSelect(event:IndexChangeEvent):void {
				adviceZoneVideoPlayer.source = hostComponent.href.createRelativeHref(null, adviceZoneVideoList.selectedItem.@href).url;
				trace(hostComponent.href.createRelativeHref(null, adviceZoneVideoList.selectedItem.@href).url);
			}
			
		]]>
	</fx:Script>
	
	<s:states>
		<s:State name="normal" />
		<s:State name="exercise_selector" />
	</s:states>
	
	<s:transitions>
		<s:Transition fromState="normal" toState="exercise_selector">
			<s:Move target="{popoutExerciseSelector}" />
		</s:Transition>
		
		<s:Transition fromState="exercise_selector" toState="normal">
			<s:Move target="{popoutExerciseSelector}" />
		</s:Transition>
	</s:transitions>
	
	<s:Group width="100%" height="100%">
		<s:layout>
			<s:BasicLayout />
		</s:layout>
		
		<!-- The left hand side -->
		<s:Group width="50%" rollOver="currentState='normal'" top="35">
			<s:layout>
				<s:VerticalLayout paddingLeft="20" paddingRight="20" paddingTop="10" paddingBottom="10" />
			</s:layout>
			
			<!-- this is for the rotating course selector -->
			<flashcomponents:CourseSelectorWidget id="courseSelectorWidget" />
		</s:Group>
		
		<!-- The popout exercise selector -->
		<ui:PopoutExerciseSelector id="popoutExerciseSelector" href="{hostComponent.href}" width="50%" x.normal="{width / 2}" x.exercise_selector="0" top="85" height="300" exerciseSelected="onPopoutExerciseSelected(event)" />
		
		<!-- The right hand side -->
		<s:BorderContainer right="0" width="50%" height="100%" backgroundColor="#F2F2F2" cornerRadius="12">
			<s:layout>
				<s:VerticalLayout paddingLeft="20" paddingRight="20" paddingTop="10" paddingBottom="10" />
			</s:layout>
			
			<s:borderStroke>
				<s:SolidColorStroke color="#E4E4E4" weight="1" />
			</s:borderStroke>
			
			<s:HGroup width="100%">
				<s:SWFLoader id="courseIcon" source="@Embed(source='skins/ielts/assets/assets.swf', symbol='ReadingIcon')" width="30" height="30">
					<s:filters>
						<s:GlowFilter strength="3" blurX="0" blurY="0" color="#AAAAAA" alpha="0.8" />
					</s:filters>
				</s:SWFLoader>
				
				<s:RichText id="courseTitleLabel" fontSize="20"  paddingTop="7"/>
			</s:HGroup>
			
			<s:RichText id="courseDescriptionLabel" width="100%" />
			
			<!-- The accordian -->
			<tink:Accordion width="100%" height="100%" creationPolicy="all" borderVisible="false" contentBackgroundAlpha="0" duration="100" change="onAccordianChange(event)">
				
				<!-- Practice zone -->
				<s:NavigatorContent label="Practice zone" width="100%"  >
					<s:VGroup left="0" right="20" top="0" bottom="10" gap="20">
						<!-- The unit title and description box -->
						<s:Group width="100%">
							<s:Rect width="100%" height="100%">
								<s:fill>
									<s:SolidColor color="#E1E1E1" />
								</s:fill>
							</s:Rect>
							
							<s:VGroup width="100%" paddingLeft="10" paddingRight="10" paddingTop="10" paddingBottom="10">
								<s:Label id="unitCaption" fontSize="14" fontWeight="bold"  />
								<s:RichText id="unitDescription" width="100%" />
							</s:VGroup>
						</s:Group>
						
						<!-- The unit list -->
						<s:Group left="0" right="0" top="5" bottom="5">
							<s:List id="unitList" top="0" bottom="0" borderVisible="false" fontSize="12" itemRollOver="onUnitItemRollOver(event)" change="onUnitChange(event)">
								<s:layout>
									<s:TileLayout requestedColumnCount="2" requestedRowCount="6" orientation="columns" columnWidth="250" verticalGap="15" />
								</s:layout>
								
								<!-- Custom item renderer to render the label (probably not really necessary since its just text...) -->
								<s:itemRenderer>
									<fx:Component>
										<s:ItemRenderer>
											<fx:Script>
												<![CDATA[
													public override function set data(value:Object):void {
														super.data = value;
														captionLabel.text = data.@caption;
													}
												]]>
											</fx:Script>
											<s:Label id="captionLabel" fontSize="12" />
										</s:ItemRenderer>
									</fx:Component>
								</s:itemRenderer>
								
							</s:List>
						</s:Group>
					</s:VGroup>
				</s:NavigatorContent>
				
				<!-- Advice zone -->
				<s:NavigatorContent label="Advice zone">
					<s:VGroup left="0" right="0" top="10" bottom="10" horizontalAlign="center" verticalAlign="middle">
						<s:VideoPlayer id="adviceZoneVideoPlayer" autoPlay="false" width="411" height="231" />
						
						<s:List id="adviceZoneVideoList" width="411" height="40" horizontalScrollPolicy="off" borderVisible="false" change="onAdviceZoneVideoSelect(event)">
							<s:layout>
								<s:HorizontalLayout />
							</s:layout>
							
							<s:itemRenderer>
								<fx:Component>
									<s:ItemRenderer>
										<fx:Script>
											<![CDATA[
												override public function set data(value:Object):void {
													super.data = value;
													
													image.source = outerDocument.hostComponent.href.createRelativeHref(null, data.@thumbnail).url;
												}
											]]>
										</fx:Script>
										<s:Image id="image" width="54" height="30" />
									</s:ItemRenderer>
								</fx:Component>
							</s:itemRenderer>
						</s:List>
					</s:VGroup>
				</s:NavigatorContent>
				
				<!-- Exam practice -->
				<s:NavigatorContent label="Exam practice" width="100%">
					<s:DataGroup id="examPracticeDataGroup" horizontalCenter="0">
						<s:layout>
							<s:HorizontalLayout gap="40" />
						</s:layout>
						<s:itemRenderer>
							<fx:Component>
								<s:DataRenderer>
									<fx:Script>
										<![CDATA[
											import com.clarityenglish.ielts.view.zone.ExerciseEvent;
											[Embed(source='skins/ielts/assets/assets.swf', symbol='ExamPracticeListening')]
											private static const writingIcon:Class;
											
											[Embed(source='skins/ielts/assets/assets.swf', symbol='ExamPracticeListening')]
											private static const readingIcon:Class;
											
											[Embed(source='skins/ielts/assets/assets.swf', symbol='ExamPracticeListening')]
											private static const speakingIcon:Class;
											
											[Embed(source='skins/ielts/assets/assets.swf', symbol='ExamPracticeListening')]
											private static const listeningIcon:Class;
											
											public override function set data(value:Object):void {
												super.data = value;
												
												if (data) {
													switch (outerDocument.hostComponent.course.@["class"].toString()) {
														case "listening":
															iconSWFLoader.source = listeningIcon;
															break;
														case "reading":
															iconSWFLoader.source = readingIcon;
															break;
														case "speaking":
															iconSWFLoader.source = speakingIcon;
															break;
														case "writing":
															iconSWFLoader.source = writingIcon;
															break;
														default:
															throw new Error("Unknown course " + outerDocument.hostComponent.course.@["class"]);
													}
													
													
													captionLabel.text = data.@caption;
												}
											}
											
											protected function onViewButtonClick(event:MouseEvent):void {
												dispatchEvent(new ExerciseEvent(ExerciseEvent.EXERCISE_SELECTED, data.@href));
											}
											
										]]>
									</fx:Script>
									<s:VGroup width="100" horizontalAlign="center">
										<s:SWFLoader id="iconSWFLoader" width="100" height="128" />
										<s:Label id="captionLabel" width="100%" textAlign="center" />
										<s:Button id="viewButton" label="View" click="onViewButtonClick(event)" />
									</s:VGroup>
								</s:DataRenderer>
							</fx:Component>
						</s:itemRenderer>
					</s:DataGroup>
					
				</s:NavigatorContent>
				
				<!-- Question zone -->
				<s:NavigatorContent label="Question zone">
					<s:VGroup left="0" right="0" top="10" bottom="10">
						<s:Label width="100%" text="Read about the possible questions that will arise in the IELTS exam." />
						<s:Button id="questionZoneButton" label="Click to read" />
					</s:VGroup>
				</s:NavigatorContent>
				
			</tink:Accordion>
		</s:BorderContainer>
	</s:Group>
	
</s:Skin>