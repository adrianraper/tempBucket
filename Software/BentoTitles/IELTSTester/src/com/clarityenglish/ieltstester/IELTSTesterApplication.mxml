<?xml version="1.0" encoding="utf-8"?>
<bento:BentoApplication xmlns:fx="http://ns.adobe.com/mxml/2009" 
			   			xmlns:s="library://ns.adobe.com/flex/spark" 
			   			xmlns:mx="library://ns.adobe.com/flex/mx"
			  			xmlns:bento="com.clarityenglish.bento.*"
						xmlns:tester="com.clarityenglish.ieltstester.view.tester.*"
						creationComplete="creationComplete(event)"
						addedToStage="addedToStage(event)">
	
	<fx:Metadata>
		[SWF(width=900, height=600)]
	</fx:Metadata>
	
	<fx:Style source="ieltstester.css" />
	
	<fx:Script>
		<![CDATA[
			import com.clarityenglish.bento.BBNotifications;
			import com.clarityenglish.bento.BentoFacade;
			import com.clarityenglish.bento.vo.Href;
			
			import mx.events.FlexEvent;
			
			import spark.events.IndexChangeEvent;
			
			override protected function get facade():BentoFacade {
				return IELTSTesterApplicationFacade.getInstance();
			}
			
			protected function creationComplete(event:FlexEvent):void {
				// Kick off the PureMVC framework with a STARTUP notification
				facade.sendNotification(BBNotifications.STARTUP, this);
			}
			
			protected function addedToStage(event:Event):void {
				// Select the first entry by default
				buttonBar.selectedIndex = 0;
				buttonBar.dispatchEvent(new IndexChangeEvent(IndexChangeEvent.CHANGE));
			}
			
			protected function onButtonBarChange(event:IndexChangeEvent):void {
				var href:Href = new Href(Href.XHTML, buttonBar.selectedItem.filename, buttonBar.selectedItem.currentDir);
				testerView.href = href;
			}
			
			protected function onShowAnswersClick(event:Event):void {
				facade.sendNotification(BBNotifications.SHOW_ANSWERS);
			}
			
		]]>
	</fx:Script>
	
	<bento:layout>
		<s:VerticalLayout gap="1" />
	</bento:layout>
	
	<s:HGroup width="100%">
		<s:ButtonBar id="buttonBar" requireSelection="true" change="onButtonBarChange(event)">
			<s:dataProvider>
				<s:ArrayCollection>
					<fx:Object label="Test cases" filename="menu.xml" currentDir="http://dock.projectbench/Content/IELTSTester-Dave" />
					<fx:Object label="Road to IELTS" filename="menu.xml" currentDir="http://dock.projectbench/Content/RoadToIELTS2-Academic" />
				</s:ArrayCollection>
			</s:dataProvider>
		</s:ButtonBar>
		
		<s:Spacer width="100%" />
		
		<s:Button label="Show answers" click="onShowAnswersClick(event)"/>
	</s:HGroup>
	
	<tester:TesterView id="testerView" width="100%" height="100%" />
	
</bento:BentoApplication>