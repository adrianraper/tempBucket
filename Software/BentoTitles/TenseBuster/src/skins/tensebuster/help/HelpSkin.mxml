<?xml version="1.0" encoding="utf-8"?>

<s:Skin xmlns:fx="http://ns.adobe.com/mxml/2009" 
		xmlns:s="library://ns.adobe.com/flex/spark" 
    	xmlns:fb="http://ns.adobe.com/flashbuilder/2009" alpha.disabled="0.5" xmlns:exercise="skins.tensebuster.assets.exercise.*">
	
	<fx:Metadata>
		[HostComponent("com.clarityenglish.tensebuster.view.help.HelpView")]
	</fx:Metadata>
	<fx:Script>
		<![CDATA[
			import mx.collections.XMLListCollection;
		]]>
	</fx:Script>
	
	<fx:Declarations>
		<s:DropShadowFilter id="dropShadowFilter" angle="90" distance="1.5" alpha="0.6" blurX="7" blurY="7" />
	</fx:Declarations>
	
	<fx:Script>
		<![CDATA[
			import com.clarityenglish.common.model.interfaces.CopyProvider;
			
			public function getCopyProvider():CopyProvider {
				return hostComponent.getCopyProvider();
			}
		]]>
	</fx:Script>

    <s:states>
        <s:State name="normal" />
        <s:State name="disabled" />
    </s:states>
	
	<s:Group width="100%" height="100%" filters="{[dropShadowFilter]}">
		<!--rectangle panel-->
		<s:Rect left="29" right="29" bottom="15" top="70">
			<s:fill>
				<s:SolidColor color="0xFFFFFF"/>
			</s:fill>
		</s:Rect>
		<!--top panel-->	
		<exercise:topPanel top="40" right="28" left="28" />
	</s:Group>
    
	<s:List id="helpList" left="30" right="30" top="100" contentBackgroundColor="0xec1c32">
		<s:layout>
			<s:TileLayout horizontalGap="50" verticalGap="50" paddingLeft="20" paddingRight="20" paddingTop="10" paddingBottom="10" requestedColumnCount="3" />
		</s:layout>
		<s:itemRenderer>
			<fx:Component>
				<s:ItemRenderer>
					<s:Label text="{data.@caption}"/>
				</s:ItemRenderer>
			</fx:Component>
		</s:itemRenderer>
	</s:List>
	
	<s:DataGroup id="helpDataGroup" dataProvider="{new XMLListCollection(helpList.selectedItem.group)}" left="50" right="50" top="250">
		<s:layout>
			<s:VerticalLayout gap="20" />
		</s:layout>
		<s:itemRenderer>
			<fx:Component>
				<s:DataRenderer>
					<fx:Script>
						<![CDATA[
							import flashx.textLayout.elements.TextFlow;
							
							import mx.collections.XMLListCollection;
							
							import spark.utils.TextFlowUtil;
							
							private var contentString:String;
							private var contentTextFlow:TextFlow;
							private var numberContentString:String;
							private var numberContentXML:XML;
							
							override public function set data(value:Object):void {
								super.data = value;
								
								if (data) {
									if (data.content != "false") {
										contentRichText.visible = true;
										contentRichText.includeInLayout = true;
										contentString = outerDocument.getCopyProvider().getCopyForId(data.content);
										contentTextFlow = TextFlowUtil.importFromString(contentString);
										contentRichText.textFlow = contentTextFlow;
									} else {
										contentRichText.visible = false;
										contentRichText.includeInLayout = false;
									}
									
									if (data.numberContent != "false") {
										numberContentDataGroup.visible = true;
										numberContentDataGroup.includeInLayout = true;
										numberContentString = outerDocument.getCopyProvider().getCopyForId(data.numberContent);
										numberContentXML = XML(numberContentString);
										numberContentDataGroup.dataProvider = new XMLListCollection(numberContentXML.item);
									} else {
										numberContentDataGroup.visible = false;
										numberContentDataGroup.includeInLayout = false;
									}
								}								
							}
						]]>
					</fx:Script>
					<s:HGroup>
						<s:VGroup>
							<s:Label text="{data.title}" />
							<s:DataGroup id="numberContentDataGroup">
								<s:layout>
									<s:VerticalLayout gap="20"/>
								</s:layout>
								<s:itemRenderer>
									<fx:Component>
										<s:DataRenderer>
											<s:Label text="{data}" />
										</s:DataRenderer>
									</fx:Component>
								</s:itemRenderer>
							</s:DataGroup>
							<s:RichText id="contentRichText" />
						</s:VGroup>
					</s:HGroup>										
				</s:DataRenderer>
			</fx:Component>
		</s:itemRenderer>
	</s:DataGroup>
   
</s:Skin>
